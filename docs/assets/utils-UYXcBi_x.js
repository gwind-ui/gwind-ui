import{g as p}from"./getActiveElement-FUKBWQwh.js";import{e as L,b as C,i as k}from"./useForwardExpose-BfXw-hnz.js";import{P as A}from"./Primitive-BG2Gt-GN.js";import{r as O,d as w,B as N,s as y,b as U,o as K,j as x,g as B,f as P,q}from"./vue.esm-bundler-CDO2oHXK.js";import{g as D,f as i,A as E,a as I,b as M,c as b,E as _}from"./utils-CiIgqHKy.js";const R=L(()=>O([]));function V(){const s=R();return{add(a){const t=s.value[0];a!==t&&(t==null||t.pause()),s.value=T(s.value,a),s.value.unshift(a)},remove(a){var t;s.value=T(s.value,a),(t=s.value[0])==null||t.resume()}}}function T(s,a){const t=[...s],l=t.indexOf(a);return l!==-1&&t.splice(l,1),t}function $(s){return s.filter(a=>a.tagName!=="A")}var j=w({__name:"FocusScope",props:{loop:{type:Boolean,required:!1,default:!1},trapped:{type:Boolean,required:!1,default:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["mountAutoFocus","unmountAutoFocus"],setup(s,{emit:a}){const t=s,l=a,{currentRef:g,currentElement:F}=C(),v=O(null),h=V(),m=N({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}});y(n=>{if(!k)return;const e=F.value;if(!t.trapped)return;function o(c){if(m.paused||!e)return;const d=c.target;e.contains(d)?v.value=d:i(v.value,{select:!0})}function f(c){if(m.paused||!e)return;const d=c.relatedTarget;d!==null&&(e.contains(d)||i(v.value,{select:!0}))}function u(c){e.contains(v.value)||i(e)}document.addEventListener("focusin",o),document.addEventListener("focusout",f);const r=new MutationObserver(u);e&&r.observe(e,{childList:!0,subtree:!0}),n(()=>{document.removeEventListener("focusin",o),document.removeEventListener("focusout",f),r.disconnect()})}),y(async n=>{const e=F.value;if(await q(),!e)return;h.add(m);const o=p();if(!e.contains(o)){const u=new CustomEvent(E,_);e.addEventListener(E,r=>l("mountAutoFocus",r)),e.dispatchEvent(u),u.defaultPrevented||(I($(M(e)),{select:!0}),p()===o&&i(e))}n(()=>{e.removeEventListener(E,c=>l("mountAutoFocus",c));const u=new CustomEvent(b,_),r=c=>{l("unmountAutoFocus",c)};e.addEventListener(b,r),e.dispatchEvent(u),setTimeout(()=>{u.defaultPrevented||i(o??document.body,{select:!0}),e.removeEventListener(b,r),h.remove(m)},0)})});function S(n){if(!t.loop&&!t.trapped||m.paused)return;const e=n.key==="Tab"&&!n.altKey&&!n.ctrlKey&&!n.metaKey,o=p();if(e&&o){const f=n.currentTarget,[u,r]=D(f);u&&r?!n.shiftKey&&o===r?(n.preventDefault(),t.loop&&i(u,{select:!0})):n.shiftKey&&o===u&&(n.preventDefault(),t.loop&&i(r,{select:!0})):o===f&&n.preventDefault()}}return(n,e)=>(K(),U(P(A),{ref_key:"currentRef",ref:g,tabindex:"-1","as-child":n.asChild,as:n.as,onKeydown:S},{default:x(()=>[B(n.$slots,"default")]),_:3},8,["as-child","as"]))}}),Q=j;function W(s){return s?"open":"closed"}function X(s){const a=p();for(const t of s)if(t===a||(t.focus(),p()!==a))return}export{Q as F,X as f,W as g};
